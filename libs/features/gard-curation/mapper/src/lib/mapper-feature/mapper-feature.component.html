<mat-vertical-stepper [linear] = true #stepper>
  <!--<mat-step [completed] = session>
    <ng-template matStepLabel>Connect to datasource</ng-template>
    <ncats-frontend-library-connection-form (connection)="setConnection($event)"></ncats-frontend-library-connection-form>
    <div>
      <button mat-raised-button matStepperNext>Next</button>
    </div>
  </mat-step>-->
<!--
  <mat-step [completed] = "objectFields">
-->
<!--  <mat-step [completed] = "objectFields">
    <ng-template matStepLabel>Select object field to map</ng-template>
    <ncats-frontend-library-object-tree
      (fieldSelectChange) = "setObjectFields($event)"
    ></ncats-frontend-library-object-tree>
    <div>
      <button mat-raised-button [color] = "'warn'" matStepperPrevious>Back</button>
      <button mat-raised-button matStepperNext>Next</button>
    </div>
  </mat-step>
  <mat-step [optional]="true">
    <ng-template matStepLabel>Select datasources and fields</ng-template>

    <div class="mapper-holder">
      <div fxLayout = "row" fxLayoutAlign="space-around center">
        <div fxFlex = "75">
          <ncats-frontend-library-search-bar
            (inputChangeEvent)="filter($event)"
            [disabled]=" allSourcesLoading"
            [placeholderStr]="'Filter Sources'"
          ></ncats-frontend-library-search-bar>
        </div>
      </div>
      <div fxLayout = "row" fxLayoutAlign="space-around center">
        <div fxFlex = "95">
          <ncats-frontend-library-mapper-interface
            [options]="filteredSources"
            [allSourcesLoading] = allSourcesLoading
            [searchTerm] = searchTerm
            (mappedObjectChange)="setFields($event)"></ncats-frontend-library-mapper-interface>
          <div>
            <button mat-raised-button [color] = "'warn'" matStepperPrevious>Back</button>
            <button mat-raised-button matStepperNext>Next</button>
          </div>
        </div>
      </div>
    </div>
  </mat-step>
  <mat-step [optional]="true">
    <ng-template matStepLabel>Test by disease</ng-template>
    <div fxLayout = "row" fxLayoutAlign="space-around center">
      <div fxFlex = "75">
        You are mapping:<br>
        <div fxLayout="row">
          <div fxFlex = 20>
            <div *ngFor = "let entry of selectedFields">
              <div *ngFor = "let field of entry.fields">
                {{entry.source}}: {{field}}
              </div>
            </div>
          </div>
          <div fxFlex="5" fxFlexAlign="center">
            To
          </div>
          <div fxFlex = 20>
            <div *ngFor = "let entry of objectFields">
              Disease: {{entry.field}}
            </div>
          </div>
        </div>
      </div>
    </div>
    <div fxLayout = "row" fxLayoutAlign="space-around center">
      <div fxFlex = "75">
        <ncats-frontend-library-search-bar
          (inputChangeEvent)="typeahead($event)"
          (query) = "search($event)"
          [placeholderStr]="'Fetch by disease'"
        ></ncats-frontend-library-search-bar>
      </div>
    </div>
    <div fxLayout = "row" fxLayoutAlign="space-around center" *ngIf = diseaseResult>
      <div fxFlex = "75">
        <div *ngFor = "let field of diseaseResult | keyvalue">
          {{field.key}}: {{field.value}}
        </div> <br>
      </div>
    </div>
    <div>
      <button mat-raised-button [color] = "'warn'" matStepperPrevious>Back</button>
      <button mat-raised-button matStepperNext>Next</button>
    </div>
  </mat-step>
  <mat-step [optional]="true" >
    <ng-template matStepLabel>Test by disease set</ng-template>
    <button mat-raised-button (click)="runQuery()">Fetch data</button>
    <div fxLayout = "row wrap" fxLayoutAlign="space-around center" *ngIf = diseaseResults.length >
      <div fxFlex = "95" *ngFor = "let diseaseResult of diseaseResults">
        <div *ngFor = "let field of diseaseResult | keyvalue">
          {{field.key}}: {{field.value}} <br>
        </div>
        <br>
      </div>
    </div>
    <div>
      <button mat-raised-button [color] = "'warn'" matStepperPrevious>Back</button>
      <button mat-raised-button matStepperNext>Next</button>
    </div>
  </mat-step>-->
  <mat-step >
    <ng-template matStepLabel>Build</ng-template>
    This may take a while.
    <button mat-raised-button (click)="runQuery()">Build</button>
  <!--
    <button mat-raised-button (click)="mapDataDictionary()">Map Data Dictionary</button>

    <button mat-raised-button (click)="createReference()">Save Data Dictionary</button>


    <button mat-raised-button (click)="checkSources()">Check Sources</button>
-->
<!--    <button mat-raised-button (click)="getHierarchy()">Get Hierarchy</button>
    <button mat-raised-button (click)="writeTree(dataz)">Write Hierarchy</button>-->


   <!-- <button mat-raised-button (click)="buildInheritance()">Build Inheritance</button>

    <button mat-raised-button (click)="initialBuild()">Initial Build</button>-->
<!--
    <button mat-raised-button (click)="initialBuild()">Initial Build</button>
-->
    <button mat-raised-button (click)="fetchEpidemiology()">Fetch Epidemiology</button>

    <button mat-raised-button (click)="fetchGenes()">Fetch Genes</button>
<!--
    <button mat-raised-button (click)="buildGARDData()">build GARD Data</button>
-->
    <div>
      <button mat-button matStepperPrevious>Back</button>
      <button mat-button matStepperNext>Next</button>
    </div>
  </mat-step>
</mat-vertical-stepper>
